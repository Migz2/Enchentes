import pandas as pd

dataframe = pd.read_csv("../dados_ench/enchentes/enchentes.csv")

dataframe_fe = dataframe[["date" ,"temperature_2m", "relative_humidity_2m", "rain", "cloud_cover", "Nível"]].copy()
dataframe_fe["temperature_2m_lag_1"] = dataframe_fe["temperature_2m"].shift(1)
dataframe_fe["temperature_2m_lag_2"] = dataframe_fe["temperature_2m"].shift(2)
dataframe_fe["temperature_2m_lag_3"] = dataframe_fe["temperature_2m"].shift(3)
dataframe_fe["temperature_2m_lag_4"] = dataframe_fe["temperature_2m"].shift(4)
dataframe_fe["temperature_2m_avg_4h"] = dataframe_fe[["temperature_2m", "temperature_2m_lag_1", "temperature_2m_lag_2", "temperature_2m_lag_3", "temperature_2m_lag_4"]].mean(axis=1)
dataframe_fe["relative_humidity_2m_lag_1"] = dataframe_fe["relative_humidity_2m"].shift(1)
dataframe_fe["relative_humidity_2m_lag_2"] = dataframe_fe["relative_humidity_2m"].shift(2)
dataframe_fe["relative_humidity_2m_lag_3"] = dataframe_fe["relative_humidity_2m"].shift(3)
dataframe_fe["relative_humidity_2m_lag_4"] = dataframe_fe["relative_humidity_2m"].shift(4)
dataframe_fe["relative_humidity_2m_avg_4h"] = dataframe_fe[["relative_humidity_2m", "relative_humidity_2m_lag_1", "relative_humidity_2m_lag_2", "relative_humidity_2m_lag_3", "relative_humidity_2m_lag_4"]].mean(axis=1)
dataframe_fe["rain_lag_1"] = dataframe_fe["rain"].shift(1)
dataframe_fe["rain_lag_2"] = dataframe_fe["rain"].shift(2)
dataframe_fe["rain_lag_3"] = dataframe_fe["rain"].shift(3)
dataframe_fe["rain_lag_4"] = dataframe_fe["rain"].shift(4)
dataframe_fe["rain_avg_4h"] = dataframe_fe[["rain", "rain_lag_1", "rain_lag_2", "rain_lag_3", "rain_lag_4"]].mean(axis=1)
dataframe_fe["cloud_cover_lag_1"] = dataframe_fe["cloud_cover"].shift(1)
dataframe_fe["cloud_cover_lag_2"] = dataframe_fe["cloud_cover"].shift(2)
dataframe_fe["cloud_cover_lag_3"] = dataframe_fe["cloud_cover"].shift(3)
dataframe_fe["cloud_cover_lag_4"] = dataframe_fe["cloud_cover"].shift(4)
dataframe_fe["cloud_cover_avg_4h"] = dataframe_fe[["cloud_cover", "cloud_cover_lag_1", "cloud_cover_lag_2", "cloud_cover_lag_3", "cloud_cover_lag_4"]].mean(axis=1)
dataframe_fe["Nível_lag_1"] = dataframe_fe["Nível"].shift(1)
dataframe_fe["Nível_lag_2"] = dataframe_fe["Nível"].shift(2)
dataframe_fe["Nível_lag_3"] = dataframe_fe["Nível"].shift(3)
dataframe_fe["Nível_lag_4"] = dataframe_fe["Nível"].shift(4)
dataframe_fe["Nível_avg_4h"] = dataframe_fe[["Nível", "Nível_lag_1", "Nível_lag_2", "Nível_lag_3", "Nível_lag_4"]].mean(axis=1)
dataframe_fe["relative_humidity_2m_lag_1"] = dataframe_fe["relative_humidity_2m"].shift(1)

dataframe_fe.head()

dataframe_fe.to_csv("../dados_ench/enchentes/enchentes.csv")